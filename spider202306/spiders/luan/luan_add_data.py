'''
    部分公告找到了中标公告未找到招标公告
        1、通过网址信息，请求到所有页面请求信息，
        2、拼接出招标公告网页信息
        3、请求网页内容，解析数据
'''

from luan import *
import requests
import json
urls = ["https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=e4ce0d10-92de-4aa4-8b77-5a38a275e33c&categorynum=001001005&relationguid=c656c6ab-6feb-46a5-b022-8210fa83ef1c", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=3fa41209-fc53-4647-af8c-a05b7d5f001c&categorynum=001001005&relationguid=5c695dd4-199d-4e74-ba32-3462a506e07f", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=63eef135-dc80-4917-9f32-3e1f4965bc81&categorynum=001001005&relationguid=6bdb944b-3650-4ad2-80e3-8577dcd61ee6", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=0d18b0cb-56a5-4fcc-8b3c-53297f3911ee&categorynum=001001005&relationguid=c595d6ac-310d-482b-a355-41a9b1d91ff1", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=7c56371f-5f2b-46f7-85df-7df3ef0412d6&categorynum=001001005&relationguid=b0231fa5-3d63-4833-be35-f40a6f2b0c7b", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=30bd8cc0-fafc-4a34-9f0c-5cbc5e66b42e&categorynum=001001005&relationguid=89300344-019c-47ce-9768-2a64e185a734", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=70a5555f-494b-4a19-8f3d-399abad89ef9&categorynum=001001005&relationguid=c49a30c6-1f5a-4766-8d30-1ab52a2b76c1", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=6087bc3d-1275-4e62-b9e6-349554c83815&categorynum=001001005&relationguid=bad66c61-19f2-406e-a982-7966555b359b", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=b0ddd997-91ed-4321-8ec1-73a0ae60efa3&categorynum=001001005&relationguid=7fef0cee-75ff-4f35-bd2e-f289cf8ed619", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=104f6e63-d889-4deb-ae65-57ddff81953b&categorynum=001001005&relationguid=94cdf322-de70-4654-8615-541a8a9f45c2", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=a90fd5b6-2be0-408e-8cbd-5f2564eb688d&categorynum=001001005&relationguid=33a1c597-7821-4c1f-a699-20d90898d84f", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=ae381783-1e62-4658-8588-98d2f7664efb&categorynum=001001005&relationguid=20f964c4-1e6c-4f17-9a54-ff668972f00e", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=1c8e3743-643f-4914-9406-c51fa708bc04&categorynum=001001005&relationguid=9138f3a7-46a6-4113-a608-f9319d2ffd40", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=b8c6806f-a1b4-45c7-8477-bb64c444739e&categorynum=001001005&relationguid=b7100a41-c209-40a8-b0e3-29d01ad649a1", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=7a0c87d9-0973-49c5-8142-51e259a0d72a&categorynum=001001005&relationguid=ce7bc63d-615d-4767-948d-b0b2d5df6a93", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=aa8388cf-b43c-4632-b5ff-5c5a2b04d09f&categorynum=001001005&relationguid=49073fcf-fd11-4864-8188-e0445a5c0456", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=aee72096-6a21-4652-8c1a-804b19baac2f&categorynum=001001005&relationguid=ec77aff2-380b-4d32-929f-a2ca3885f7c0", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=f429dc8d-db18-4444-b3ac-936386bac376&categorynum=001001005&relationguid=81439307-7c04-4f45-9cf5-b04ca8c0fee8", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=39cab906-e4e5-4f19-8b0b-d8f03c8c86bd&categorynum=001001005&relationguid=b2a2f108-6c47-40fe-b6cf-6a933d6520d8", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=716de194-1391-4db7-8cba-56da0caf4eca&categorynum=001001005&relationguid=1e9e6d2e-fa03-42f4-9e8b-f0a55bc750e3", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=ed310172-b10f-4570-b0ad-40f54e95cf13&categorynum=001001005&relationguid=4f27e6ec-515a-474c-bde5-b1ef11bb88b0", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=16e46fa4-38d4-4997-a963-1894263edb14&categorynum=001001005&relationguid=f8ae417e-a7fd-430b-93dd-a193d82b62a9", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=625927ee-1649-42aa-aeb4-273de63440e5&categorynum=001001005&relationguid=088f6395-624c-4c0f-b59d-489599f7fdf3", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=df912fbf-6dad-4896-be1d-f6772df5658f&categorynum=001001005&relationguid=4f70dde2-7fef-4a55-ba72-27ddb7040dd3", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=2a370822-c100-4bca-8d76-ab2c5c0dda4b&categorynum=001001005&relationguid=d56961c0-e279-4623-a1d9-8f8834396b31", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=46960266-6702-4980-a9b9-8b0909871766&categorynum=001001005&relationguid=75ee6eb7-72ae-44ff-9d25-7a200cc6a715", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=4d513499-5949-4ed1-affe-c24156a9ef0d&categorynum=001001005&relationguid=48b16319-88f1-4b95-bf2f-08356dc458b8", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=42ef0811-2e51-4200-aaaf-b64136a79d72&categorynum=001001005&relationguid=0c636e90-09c7-4ebc-99b0-47815ce8af0e", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=7be2728e-97b8-404b-94d3-3acd87f10020&categorynum=001001005&relationguid=58f84a16-aff5-491a-96eb-acd812d8746b", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=da72e2bc-a485-4aaf-9994-11b02abe8f8b&categorynum=001001005&relationguid=e6f4089d-893d-4a96-abc3-30f346c270e4", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=9cc257f9-aff1-47c9-a551-f523662cd8ad&categorynum=001001005&relationguid=acf75d1f-b21b-48ef-81f9-98a536eaedff", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=c2085534-d045-42fb-a530-cfece9ab6972&categorynum=001001005&relationguid=6d49e2f6-5184-4ad5-a3f0-b71ef3cb6044", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=4fcf292f-8f9d-4a7a-a08b-6631964cc114&categorynum=001001005&relationguid=7f1ee02e-65fb-47a9-99bf-264e86a195cf", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=808d96ee-9bfd-4bf0-b1cd-09ed90775ea9&categorynum=001001005&relationguid=3bdbde28-5d10-4d84-ad81-7c7e584ccb2c", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=5e8f7e8a-2f96-4a01-8ba1-4addb12b3d6c&categorynum=001001005&relationguid=56bfaf7b-a473-4325-8c60-a9d0f80ede8c", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=2a29e9e8-401d-4463-946e-a3883f97b75c&categorynum=001001005&relationguid=a6f6439e-64b3-4e8d-9641-ee4ab2b40e72", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=d85abd85-df75-46f7-b311-0080df39cb54&categorynum=001001005&relationguid=8abebc0b-26fa-4551-8772-5246fa521f3d", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=49a46c06-efdf-412a-810b-479003579817&categorynum=001001005&relationguid=c1514cb8-d0da-4109-8bbb-cfb369f00bc0", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=ad72b8f7-de83-47b4-b04f-2f9a368e848c&categorynum=001001005&relationguid=a676d19c-d22a-42d8-af3c-6e7aa24c3bd9", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=8e055e14-d301-4b7e-8322-b562e3924ac0&categorynum=001001005&relationguid=849a3948-5cc8-4217-a6e7-3f461223c07b", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=eb28ea49-ec80-4ef7-b83c-eb414ca34bdf&categorynum=001001005&relationguid=2d402f47-bde4-460c-b97a-a1749b1782f6", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=0d1e5e3d-617f-4327-bdb6-722e1ba57761&categorynum=001001005&relationguid=1957ba3d-2742-431d-808c-4b6dd5a1972e", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=e22cd20a-ffa0-4120-a6e6-29aa4dd6efa7&categorynum=001001005&relationguid=15d32e68-5ce7-4b6e-8254-822fef607e61", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=7ef46afd-bedf-4429-ace0-fb1dd8caf646&categorynum=001001005&relationguid=d2e6e4a5-7bd5-4ab2-ac1e-6e8e71dcd8cc", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=c17c21c3-36f1-4a27-9bd0-a61260b1cff6&categorynum=001001005&relationguid=f2ff55b7-d90b-451b-a2b7-7830a4a4b6a1", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=b7c9477b-8c50-46fc-8ba7-62688ae17d39&categorynum=001001005&relationguid=866f21dd-8f34-4ebf-b5f9-376db84b10a6", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=dd29ca5e-0932-42eb-aaf8-9cac1e2ca7fd&categorynum=001001005&relationguid=5422618d-addf-49c1-99dc-790d81a6e901", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=59c5fdb9-2b93-466b-b0cc-dc5f274ae173&categorynum=001001005&relationguid=c920f0c7-9be1-42b8-964c-7df79b4e47fb", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=ee2875ff-cfa2-42c3-b09f-cd54b88b1b8f&categorynum=001001005&relationguid=1c9fec00-1b56-4c0a-a3a3-2c826d82e52b", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=84c49ae7-ec2c-4adf-97fd-43ca566ed8e6&categorynum=001001005&relationguid=a01cd0da-d08a-4894-a186-fba5d067441b", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=f6616512-f495-43e1-b27f-939d02ea369d&categorynum=001001005&relationguid=442c8fa1-f81d-4468-be88-c02395c68ea2", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=6f838c5b-cfe2-4ce0-9baa-ed869399f2d2&categorynum=001001005&relationguid=7c7e027f-b47d-46a6-ba09-5485b05b4998", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=afca4993-766c-420c-9288-df9ebe0e596a&categorynum=001001005&relationguid=c374d5d3-8a98-48e1-b743-bcc54032f193", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=f16f8160-d46d-487f-86d2-8a1bf3b6793b&categorynum=001001005&relationguid=159195ce-4106-46a2-8712-cc2d803c87ca", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=fb78fc7d-7385-46a4-8c1c-8eb8498d7739&categorynum=001001005&relationguid=0a5e965a-a25a-4fb2-b5d0-3c2cf87d97ca", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=3e40ce53-65b3-4005-9484-92b2396d76e8&categorynum=001001005&relationguid=19370f5c-2109-4d88-aeaa-025c58e33228", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=ff7547d2-bc78-4208-9510-b54f745dbee1&categorynum=001001005&relationguid=6beee230-dd01-484b-aece-4f6bddbf2530", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=5da89efa-27c1-4bfd-b817-3bee78b1a39e&categorynum=001001005&relationguid=f9255bab-bef7-4254-b269-e9be97133eb3", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=eee1bcde-9096-4687-be93-1a8a2c497bd5&categorynum=001001005&relationguid=ad1750d6-7ac5-4d0d-9a33-54db52424345", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=de4efaa9-23d8-4780-9170-b1cde4f59fcb&categorynum=001001005&relationguid=0ad9ac20-925a-4917-82ed-996ecdf28edc", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=cdb17175-7012-4b09-a0e8-1ab03bc52724&categorynum=001001005&relationguid=96fb7069-ab4e-46e2-98ac-cc73bf1a96b6", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=aa5e1ac9-2a81-41ec-8f55-64601f1fea3d&categorynum=001001005&relationguid=51c6db87-9a88-413d-802d-156dba5b75f1", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=477332c9-6c1e-4593-b42c-9fea8e61345d&categorynum=001001005&relationguid=4257efa1-35d4-4a10-b322-1c24e96161ba", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=a3d276fe-a9aa-40eb-87e4-89042b884bd2&categorynum=001001005&relationguid=8649bec7-d480-4288-93be-fcd78817b7c6", "https://ggzy.luan.gov.cn//jyxxparentDetail.html?infoid=88daf122-5e17-4fb8-b141-bc1e41ba4bf4&categorynum=001001005&relationguid=3bab9c78-fc8a-4aac-b352-7d240a0aeb33"]
headers = {
    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
     'Cookie': 'EPTOKEN=9577511F8ED6E0716218CD7294CB3D47DD740F91; _CSRFCOOKIE=9577511F8ED6E0716218CD7294CB3D47DD740F91; Secure; __jsluid_h=20f12820b38f06ff6a20a43848b0f89d; __jsluid_s=6b1db6d6c353f8842ced4cb2ece8957d',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36',
    'X-Requested-With': 'XMLHttpRequest'
}
headers1 = {
    'Cookie': 'Secure; __jsluid_h=20f12820b38f06ff6a20a43848b0f89d; __jsluid_s=6b1db6d6c353f8842ced4cb2ece8957d',
    'Content-Type': 'application/json;charset=UTF-8',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36',
    'X-Requested-With': 'XMLHttpRequest'
}
for url in urls:
    # 请求各个页面信息
    relationguid = re.findall("relationguid=([^&]*)",url)[0]
    categorynum = re.findall("categorynum=([^&]*)",url)[0]
    # print(relationguid,categorynum)
    payload = f"params=%7B%22relationguid%22%3A%22{relationguid}%22%2C%22categorynum%22%3A%22001001002%22%7D"
    url = "https://ggzy.luan.gov.cn/EpointWebBuilder/rest/GgSearchAction/getProjectProcess"
    response = requests.request("POST", url, headers=headers, data=payload)
    # 获取招标公告网址信息
    tender_info = json.loads(json.loads(response.text))['resultinfos']['cnum001001002']
    link_url = f"https://ggzy.luan.gov.cn//jyxx/001001/{tender_info['categorynum']}/{tender_info['custom']['infodate'].replace('-', '')}/{tender_info['custom']['infoid']}.html"
    html_text = requests.request('GET', link_url, headers=headers1, data={}).text
    open_time, method = get_tender_mess(html_text)
    print(open_time, method,link_url)


